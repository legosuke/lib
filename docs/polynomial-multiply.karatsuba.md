---
title: 多項式の乗算 (カラツバ法)
documentation_of: ../01_Math/03_Algebra/03.02.01_polynomial-multiply.karatsuba.hpp
---

## 概要

それぞれ次数上界 $n,m$ の多項式

$$A(x)=\sum_{j=0}^{n-1}a_jx^j,\ B(x)=\sum_{j=0}^{m-1}b_jx^j$$

の乗算を $O(n^{\lg{3}})$ 時間で実行する．

## アルゴリズム

$n,m$ を $2$ の累乗と仮定し、$n\ge m$ とする．このとき、$B(x)$ を次数上界 $n$ の多項式としてみなしても構わない．次のような多項式を定義する．

$$
\begin{aligned}
A^{[0]}(x)&=\sum_{j=0}^{n/2-1}a_{2j}x^j=a_0+a_2x+a_4x^2+\ldots+a_{n-2}x^{n/2-1}\\
A^{[1]}(x)&=\sum_{j=0}^{n/2-1}a_{2j+1}x^j=a_1+a_3x+a_5x^2+\ldots+a_{n-1}x^{n/2-1}
\end{aligned}
$$

同様に、$B^{[0]}(x),B^{[1]}(x)$ も定義する．このとき、$A(x)=A^{[0]}(x^2)+xA^{[1]}(x^2)$ が成り立つ．よって、

$$
\begin{aligned}
A(x)B(x)
&=(A^{[0]}(x^2)+xA^{[1]}(x^2))(B^{[0]}(x^2)+xB^{[1]}(x^2))\\
&=x^2\cdot A^{[1]}(x^2)B^{[1]}(x^2)+x\cdot(A^{[0]}(x^2)B^{[1]}(x^2)+A^{[1]}(x^2)B^{[0]}(x^2))+A^{[0]}(x^2)B^{[0]}(x^2)
\end{aligned}
$$

となり、長さ $n$ の多項式の乗算を長さ $n/2$ の多項式の乗算 $4$ つに分割することができた．しかし、このときの時間計算量は $\Theta(n^2)$ となる．

次のようにして、長さ $n/2$ の多項式の乗算を $4$ つから $3$ つに減らすことができる．次の $3$ つの多項式 $P(x),Q(x),R(x)$ を計算する．

$$
\begin{aligned}
P(x)&=A^{[1]}(x)B^{[1]}(x)\\
Q(x)&=(A^{[0]}(x)+A^{[1]}(x))(B^{[0]}(x)+B^{[1]}(x))\\
R(x)&=A^{[0]}(x)B^{[0]}(x)
\end{aligned}
$$

このとき、

$$
A(x)B(x)=x^2\cdot P(x^2)+x\cdot (Q(x^2)-P(x^2)-R(x^2))+R(x^2)
$$

となり、長さ $n/2$ の多項式の乗算 $3$ つに分割することができる．このときの時間計算量は $\Theta(n^{\lg{3}})$ となる．

